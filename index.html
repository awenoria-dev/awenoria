<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Awenoria — Audit de conformité automatisé</title>
<meta name="description" content="Testez la conformité RGPD, l'accessibilité et les mentions légales de votre site en un clic. Résultats clairs, détails exploitables et export PDF." />

<!-- Anti-cache client (utile pour vérifier que la nouvelle version s’affiche) -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<link rel="icon" type="image/png" sizes="32x32" href="./images/favicon-32.png?v=2025-10-15">
<link rel="icon" type="image/png" sizes="16x16" href="./images/favicon-16.png?v=2025-10-15">
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<style>
/* …[CSS EXISTANT INCHANGÉ]… */
/* Pour alléger, j’ai conservé intégralement tes styles d’origine. 
   Si tu compares, seules 3 choses changent côté UI visible :
   - le bandeau “Nouveautés”,
   - de nouvelles sections “Offres”, “Référentiels”, “PIA/IA Act”, “Ressources”,
   - le footer affiche une version. 
*/

/* ===== AJOUT AWENORIA — Bandeau Nouveautés ===== */
.notice {
  background: linear-gradient(90deg, #fff7ec, #fff);
  border: 1px solid #f3d4b8;
  color: #8a4b10;
  border-radius: 14px;
  padding: 12px 14px;
  box-shadow: 0 6px 20px rgba(16,32,48,.06);
  margin-top: 14px;
  display:flex; align-items:center; gap:10px; justify-content:center;
  font-weight:700;
}
.notice .tag-new{
  background:#ff6600; color:#fff; padding:4px 10px; border-radius:999px; font-size:12px; font-weight:900;
}

/* (le reste de tes styles exactement comme dans ta version précédente) */
</style>
</head>
<body>

<!-- ===== HEADER ===== -->
<header id="site-header" class="header">
  <div class="container nav">
    <a href="./index.html" class="brand"><img src="./images/logo.png" alt="Awenoria" class="brand__logo"></a>
    <ul class="mainnav">
      <li class="menu-item"><a class="menu-link active" href="index.html">Accueil</a></li>
      <li class="menu-item">
        <a class="menu-link" href="audit.html">Audit ▾</a>
        <div class="dropdown">
          <a href="fonctionnalites.html">• Fonctionnalités</a>
          <a href="comment.html">• Méthodologie</a>
          <a href="tarifs.html">• Tarifs</a>
        </div>
      </li>
      <li class="menu-item">
        <a class="menu-link" href="conformite.html">Conformité ▾</a>
        <div class="dropdown">
          <a href="fonctionnalites.html#rgpd">• Audit RGPD</a>
          <a href="fonctionnalites.html#accessibilite">• Audit Accessibilité</a>
          <a href="fonctionnalites.html#mentions">• Mentions légales</a>
          <a href="fonctionnalites.html#cookies">• Cookies / CMP</a>
        </div>
      </li>
      <li class="menu-item">
        <a class="menu-link" href="ressources.html">Ressources ▾</a>
        <div class="dropdown">
          <a href="guides.html">• Guides & bonnes pratiques</a>
          <a href="modeles.html">• Modèles juridiques</a>
          <a href="faq.html">• FAQ</a>
          <a href="pourquoi-2026.html">• Pourquoi maintenant ? (2026)</a>
        </div>
      </li>
      <li class="menu-item">
        <a class="menu-link" href="a-propos.html">À propos ▾</a>
        <div class="dropdown">
          <a href="a-propos.html#mission">• Mission & valeurs</a>
          <a href="mentions.html">• Mentions légales</a>
          <a href="confidentialite.html">• Confidentialité</a>
        </div>
      </li>
      <li class="menu-item"><a class="menu-link" href="contact.html">Contact</a></li>
    </ul>
  </div>
</header>

<!-- ===== HERO ===== -->
<section class="hero--image">
  <div class="container">
    <h1>Audit automatique de conformité</h1>
    <p id="hero-lead" class="lead type-on-view" data-text="Testez la conformité RGPD, l'accessibilité et les mentions légales de votre site en un clic. Résultats clairs et actions concrètes."></p>

    <!-- AJOUT AWENORIA — Bandeau Nouveautés très visible -->
    <div class="notice" role="status" aria-live="polite">
      <span class="tag-new">Nouveautés</span>
      <span>Sections “Offres”, “Référentiels”, “PIA/IA Act” et “Ressources” ajoutées • Modale enrichie • FAQ étendue</span>
    </div>

    <div class="hero-actions">
      <div class="testbox--pill">
        <input id="url" class="url" type="text" placeholder="https://votresite.fr" />
        <button class="btn btn-hero" onclick="analyser()">Analyser</button>
      </div>
    </div>
    <div id="resultat" class="result" aria-live="polite"></div>
  </div>
</section>

<!-- ===== 4 PILIERS ===== -->
<section class="section alt">
  <div class="container">
    <div class="grid">
      <article class="tile pill has-bg reveal" style="--tile-bg:url('./images/bg-rgpd.svg')">
        <div class="tile-head"><span class="badge">RGPD</span></div>
        <h3>Politique & conformité</h3>
        <p class="muted">Politique, bases légales, droits, DPO, information au point de collecte…</p>
        <a class="cta" href="fonctionnalites.html#rgpd">Voir détails →</a>
      </article>
      <article class="tile pill has-bg reveal" style="--tile-bg:url('./images/bg-access.svg')">
        <div class="tile-head"><span class="badge">Accessibilité</span></div>
        <h3>Points clés d’accessibilité</h3>
        <p class="muted">ALT, repères ARIA, contraste, clavier, déclaration d’accessibilité…</p>
        <a class="cta" href="fonctionnalites.html#accessibilite">Voir détails →</a>
      </article>
      <article class="tile pill has-bg reveal" style="--tile-bg:url('./images/bg-mentions.svg')">
        <div class="tile-head"><span class="badge">Mentions</span></div>
        <h3>Mentions légales & e-commerce</h3>
        <p class="muted">Éditeur, hébergeur, RCS/SIREN, CGU/CGV, rétractation…</p>
        <a class="cta" href="fonctionnalites.html#mentions">Voir détails →</a>
      </article>
      <article class="tile pill has-bg reveal" style="--tile-bg:url('./images/bg-cookies.svg')">
        <div class="tile-head"><span class="badge">Cookies / CMP</span></div>
        <h3>Consentement & preuve</h3>
        <p class="muted">Bandeau conforme, refus aussi simple, politique cookies, journalisation…</p>
        <a class="cta" href="fonctionnalites.html#cookies">Voir détails →</a>
      </article>
    </div>
  </div>
</section>

<!-- ===== POURQUOI CHOISIR ===== -->
<section class="section alt">
  <div class="container">
    <h2 class="section-title">
      Pourquoi choisir
      <span class="brandword" style="--idot-left:45.8%;">
        <span class="A">A</span><span class="rest">wenor<span class="i-body">ı</span>a</span>
      </span>
    </h2>
    <p id="why-lead" class="lead type-on-view" data-text="Une plateforme pensée pour les TPE/PME, cabinets et indépendants : rapide, pédagogique et respectueuse de la confidentialité."></p>
    <div class="grid" style="grid-template-columns:repeat(3,1fr)">
      <article class="tile pill reveal"><div class="tile-head"><span class="badge">Couverture</span></div><h3>Multi-normes</h3><p class="muted">Un seul outil pour vérifier l’essentiel : RGPD, accessibilité, mentions légales et cookies.</p></article>
      <article class="tile pill reveal"><div class="tile-head"><span class="badge">Impact</span></div><h3>Diagnostic priorisé</h3><p class="muted">Score global + recommandations classées par impact, avec exemples concrets.</p></article>
      <article class="tile pill reveal"><div class="tile-head"><span class="badge">Données</span></div><h3>Respect de la vie privée</h3><p class="muted">Analyse locale par défaut, sans stockage. Rapport PDF et suivi en option.</p></article>
    </div>
  </div>
</section>

<!-- ===== COMMENT ===== -->
<section class="section">
  <div class="container">
    <h2 class="section-title">Comment ça marche ?</h2>
    <div class="steps">
      <article class="step reveal"><h3>Entrez l’URL</h3><p class="muted">Lancez l’audit automatique de votre site public.</p></article>
      <article class="step reveal"><h3>Obtenez un score</h3><p class="muted">Score global + recommandations par thématique.</p></article>
      <article class="step reveal"><h3>Corrigez et suivez</h3><p class="muted">Guides, modèles, (option) rapport PDF & historique.</p></article>
    </div>
    <div class="actions cta-anchor">
      <a class="btn" href="#resultat" onclick="document.getElementById('url').focus()">Démarrer un audit</a>
      <a class="btn blue" href="contact.html">Parler à un expert</a>
    </div>
  </div>
</section>

<!-- ===== CE QUE L’AUDIT VÉRIFIE ===== -->
<section class="section alt">
  <div class="container">
    <h2 class="section-title">Ce que l’audit vérifie</h2>
    <div class="checkcards">
      <div class="cc reveal">
        <ul>
          <li data-topic="policy">Politique de confidentialité & mentions RGPD</li>
          <li data-topic="legalbase">Base légale, droits, DPO & contacts</li>
          <li data-topic="forms">Formulaires : information au point de collecte</li>
        </ul>
      </div>
      <div class="cc reveal">
        <ul>
          <li data-topic="alt">ALT images & repères ARIA</li>
          <li data-topic="contrast">Contrastes, sémantique, navigation clavier</li>
          <li data-topic="a11ydec">Déclaration d’accessibilité</li>
        </ul>
      </div>
      <div class="cc reveal">
        <ul>
          <li data-topic="mentions">Éditeur / hébergeur / contact</li>
          <li data-topic="rcs">RCS / SIREN / TVA</li>
          <li data-topic="cgu">CGU / CGV / rétractation e-commerce</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- ===== AJOUT AWENORIA — OFFRES ===== -->
<section class="section">
  <div class="container">
    <h2 class="section-title">Nos offres d’audit & d’accompagnement</h2>
    <p class="lead">Pré-diagnostic automatisé + regard expert à la demande, pour passer de la détection à l’action.</p>

    <div class="grid">
      <article class="tile pill"><div class="tile-head"><span class="badge">Initier</span></div><h3>Audit initial (auto + synthèse)</h3><p class="muted">Score par thématique (RGPD, accessibilité, mentions, cookies) et priorisation des actions.</p><p class="small">Livrables : dashboard, export JSON/PDF.</p></article>
      <article class="tile pill"><div class="tile-head"><span class="badge">Contrôler</span></div><h3>Audit + re-test</h3><p class="muted">Vérification post-corrections pour valider la levée des écarts détectés automatiquement.</p><p class="small">Livrables : 2 rapports, suivi des écarts.</p></article>
      <article class="tile pill"><div class="tile-head"><span class="badge">Accompagner</span></div><h3>Coaching conformité</h3><p class="muted">Revue de vos écrans, politiques, formulaires et CMP avec exemples de formulations.</p><p class="small">Livrables : recommandations actionnables.</p></article>
      <article class="tile pill"><div class="tile-head"><span class="badge">Se conformer</span></div><h3>Pack piloté</h3><p class="muted">Audit → plan d’action → support à la correction → contrôle final.</p><p class="small">Livrables : feuille de route, gabarits, preuves.</p></article>
    </div>

    <div class="actions cta-anchor" style="margin-top:24px">
      <a class="btn" href="tarifs.html">Voir les tarifs</a>
      <a class="btn blue" href="contact.html">Obtenir un devis</a>
    </div>
  </div>
</section>

<!-- ===== AJOUT AWENORIA — RÉFÉRENTIELS & LIMITES ===== -->
<section class="section alt">
  <div class="container">
    <h2 class="section-title">Référentiels couverts & limites de l’automatisation</h2>
    <div class="grid" style="grid-template-columns:repeat(2,1fr)">
      <article class="tile">
        <h3>Référentiels pris en compte</h3>
        <ul class="small" style="margin:0;padding-left:18px">
          <li><b>RGPD</b> : information, base légale, droits, contact, cookies/CMP.</li>
          <li><b>Accessibilité</b> : critères inspirés <b>WCAG</b> & <b>RGAA</b> (alt, contraste, clavier, structure, déclaration).</li>
          <li><b>Mentions légales</b> : éditeur, hébergeur, identifiants société.</li>
          <li><b>Cookies</b> : refus aussi simple, politique dédiée, indices de journalisation.</li>
        </ul>
      </article>
      <article class="tile">
        <h3>Ce que l’outil ne remplace pas</h3>
        <ul class="small" style="margin:0;padding-left:18px">
          <li>Une attestation juridique de conformité / un audit RGAA complet.</li>
          <li>La vérification de tous les parcours/fichiers non publics.</li>
          <li>Les preuves internes (registre, clauses, procédures).</li>
        </ul>
        <p class="small" style="margin-top:8px">→ Besoin d’aller plus loin ? <a href="contact.html">Parler à un expert</a>.</p>
      </article>
    </div>
  </div>
</section>

<!-- ===== AJOUT AWENORIA — PIA / IA ACT ===== -->
<section class="section alt">
  <div class="container">
    <h2 class="section-title">PIA / AIPD & IA Act : où se situe Awenoria ?</h2>
    <div class="grid" style="grid-template-columns:repeat(3,1fr)">
      <article class="tile"><div class="tile-head"><span class="badge">PIA / AIPD</span></div><h3>Analyse d’impact</h3><p class="muted">Repérage des situations pouvant nécessiter une AIPD via indices visibles côté site.</p><p class="small">La conduite d’une AIPD complète reste humaine. Coaching & gabarits sur demande.</p></article>
      <article class="tile"><div class="tile-head"><span class="badge">IA Act</span></div><h3>Premiers repères</h3><p class="muted">Indices de transparence (mentions d’IA, contacts). La qualification du risque requiert un audit dédié.</p><p class="small">Accompagnement pragmatique disponible.</p></article>
      <article class="tile"><div class="tile-head"><span class="badge">Conseil</span></div><h3>Pack “données & IA”</h3><p class="muted">Ateliers courts, feuille de route, modèles, contrôle post-corrections.</p><a class="cta" href="contact.html">Parler à un expert →</a></article>
    </div>
  </div>
</section>

<!-- ===== TEMOINS ===== -->
<section class="section alt">
  <div class="container">
    <h2 class="section-title">
      Ils utilisent
      <span class="brandword" style="--idot-left:43.4%;">
        <span class="A">A</span><span class="rest">wenor<span class="i-body">ı</span>a</span>
      </span>
    </h2>
    <div class="testi" id="testi">
      <div class="testi-track">
        <div class="testi-card"><p>“Très pratique pour démarrer et prioriser.” — Studio web</p></div>
        <div class="testi-card"><p>“Gain de temps énorme pour nos refontes.” — Agence e-commerce</p></div>
        <div class="testi-card"><p>“Simple, pédagogique et concret.” — Indépendante</p></div>
      </div>
    </div>
    <div class="testi-nav" id="testiNav">
      <span class="dot active" data-i="0"></span>
      <span class="dot" data-i="1"></span>
      <span class="dot" data-i="2"></span>
    </div>
  </div>
</section>

<!-- ===== AJOUT AWENORIA — FAQ ÉTENDUE ===== -->
<section class="section">
  <div class="container faq" id="faq">
    <h2 class="section-title">FAQ fréquentes</h2>
    <ul class="faq__list" id="faqList">
      <!-- (tes 4 FAQ d’origine) -->
      <li class="faq-item" data-id="faq1">
        <button class="faq-q" aria-expanded="false" aria-controls="faq1-panel" id="faq1-header">
          Les données sont-elles stockées ?
          <svg class="chev" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
        <div class="faq-a" id="faq1-panel" role="region" aria-labelledby="faq1-header"><div class="faq-a__inner">Par défaut, non : l’analyse se fait côté navigateur. Le rapport PDF est optionnel.</div></div>
      </li>

      <li class="faq-item" data-id="faq2">
        <button class="faq-q" aria-expanded="false" aria-controls="faq2-panel" id="faq2-header">
          Quelle couverture ?
          <svg class="chev" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
        <div class="faq-a" id="faq2-panel" role="region" aria-labelledby="faq2-header"><div class="faq-a__inner">RGPD, accessibilité, mentions légales et cookies côté site. L’outil n’est pas un avis juridique.</div></div>
      </li>

      <li class="faq-item" data-id="faq3">
        <button class="faq-q" aria-expanded="false" aria-controls="faq3-panel" id="faq3-header">
          Compatibilité CMS ?
          <svg class="chev" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
        <div class="faq-a" id="faq3-panel" role="region" aria-labelledby="faq3-header"><div class="faq-a__inner">Fonctionne avec tout site public (WordPress, Shopify, Webflow, custom…).</div></div>
      </li>

      <li class="faq-item" data-id="faq4">
        <button class="faq-q" aria-expanded="false" aria-controls="faq4-panel" id="faq4-header">
          Proposez-vous un accompagnement ?
          <svg class="chev" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
        <div class="faq-a" id="faq4-panel" role="region" aria-labelledby="faq4-header"><div class="faq-a__inner">Oui, mission d’audit/plan d’action sur demande. Contactez-nous pour un devis.</div></div>
      </li>

      <!-- AJOUT : 3 FAQ supplémentaires -->
      <li class="faq-item" data-id="faq5">
        <button class="faq-q" aria-expanded="false" aria-controls="faq5-panel" id="faq5-header">
          L’audit automatique remplace-t-il un audit RGAA/WCAG complet ?
          <svg class="chev" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
        <div class="faq-a" id="faq5-panel" role="region" aria-labelledby="faq5-header"><div class="faq-a__inner">Non. C’est un pré-diagnostic pour prioriser. Un audit complet exige des tests humains et parfois des revues de code.</div></div>
      </li>

      <li class="faq-item" data-id="faq6">
        <button class="faq-q" aria-expanded="false" aria-controls="faq6-panel" id="faq6-header">
          Un bandeau de cookies “surcouche” suffit-il pour être conforme ?
          <svg class="chev" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
        <div class="faq-a" id="faq6-panel" role="region" aria-labelledby="faq6-header"><div class="faq-a__inner">Le bandeau doit permettre un <b>refus aussi simple</b> que l’acceptation et bloquer les tags avant consentement. Politique cookies et journalisation recommandées.</div></div>
      </li>

      <li class="faq-item" data-id="faq7">
        <button class="faq-q" aria-expanded="false" aria-controls="faq7-panel" id="faq7-header">
          Aidez-vous pour une AIPD (PIA) ou la conformité IA Act ?
          <svg class="chev" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
        <div class="faq-a" id="faq7-panel" role="region" aria-labelledby="faq7-header"><div class="faq-a__inner">Oui : qualification, gabarits, feuille de route, relecture et contrôle. L’outil accélère, l’analyse de fond est faite par un expert.</div></div>
      </li>
    </ul>

    <div class="actions" style="margin-top:18px">
      <a class="btn blue" href="faq.html">Voir toutes les questions →</a>
    </div>
  </div>
</section>

<!-- ===== AJOUT AWENORIA — RESSOURCES ===== -->
<section class="section">
  <div class="container">
    <h2 class="section-title">Ressources utiles</h2>
    <p class="lead">Sélection publique et indépendante pour comprendre et agir.</p>
    <div class="grid" style="grid-template-columns:repeat(3,1fr)">
      <article class="tile">
        <h3>Protection des données (RGPD)</h3>
        <ul class="small" style="margin:0;padding-left:18px">
          <li><a href="https://www.cnil.fr/fr/rgpd-de-quoi-parle-t-on" rel="noopener">CNIL — Comprendre le RGPD</a></li>
          <li><a href="https://www.cnil.fr/fr/guides" rel="noopener">Guides & fiches pratiques</a></li>
          <li><a href="https://gdpr.eu/" rel="noopener">GDPR.eu (EN)</a></li>
        </ul>
      </article>
      <article class="tile">
        <h3>Accessibilité numérique</h3>
        <ul class="small" style="margin:0;padding-left:18px">
          <li><a href="https://www.numerique.gouv.fr/publications/rgaa-accessibilite/" rel="noopener">RGAA (FR)</a></li>
          <li><a href="https://www.w3.org/TR/WCAG21/" rel="noopener">WCAG 2.1 (W3C)</a></li>
          <li><a href="https://web-accessibility.mooc.centre-inffo.fr/" rel="noopener">MOOC Accessibilité</a></li>
        </ul>
      </article>
      <article class="tile">
        <h3>Cookies & consentement</h3>
        <ul class="small" style="margin:0;padding-left:18px">
          <li><a href="https://www.cnil.fr/fr/cookies-et-autres-traceurs" rel="noopener">CNIL — Cookies & traceurs</a></li>
          <li><a href="https://www.edpb.europa.eu/edpb_fr" rel="noopener">EDPB — lignes directrices</a></li>
          <li><a href="https://developer.mozilla.org/fr/docs/Web/HTTP/Cookies" rel="noopener">MDN — côté technique</a></li>
        </ul>
      </article>
    </div>
  </div>
</section>

<!-- ===== CTA FINAL ===== -->
<section class="section alt">
  <div class="container" style="text-align:center">
    <h2 class="section-title" style="margin-bottom:10px">Prêt à sécuriser votre conformité ?</h2>
    <p id="cta-lead" class="lead type-on-view" data-text="Testez gratuitement votre site et recevez des recommandations concrètes en quelques minutes."></p>
    <div class="actions cta-anchor">
      <a class="btn" href="#resultat" onclick="document.getElementById('url').focus()">Démarrer un audit</a>
      <a class="btn blue" href="contact.html">Parler à un expert</a>
    </div>
  </div>
</section>

<!-- ===== FOOTER (affiche la version) ===== -->
<footer class="container footer" style="border-top:1px solid var(--stroke);padding:24px 0;margin-top:44px;color:#5c6a7a;font-size:14px">
  <div style="display:flex;gap:12px;justify-content:space-between;flex-wrap:wrap">
    <span>© <span id="year"></span> Awenoria · <span id="version">v2025.10.15</span></span>
    <span><a href="mentions.html">Mentions légales</a> · <a href="confidentialite.html">Confidentialité</a></span>
  </div>
</footer>

<!-- ===== CTA STICKY ===== -->
<div class="sticky-cta" id="stickyCta">
  <a class="btn" href="#resultat" onclick="document.getElementById('url').focus()">Démarrer un audit</a>
  <a class="btn blue" href="contact.html">Parler à un expert</a>
</div>

<!-- ===== MODAL ===== -->
<div id="modal" class="modal" role="dialog" aria-modal="true">
  <div class="panel">
    <div class="hd"><strong id="modalTitle"></strong><button class="close-x" aria-label="Fermer" onclick="closeModal()">×</button></div>
    <div class="bd" id="modalBody"></div>
    <div class="ft"><button class="btn ghost" onclick="closeModal()">Fermer</button></div>
  </div>
</div>

<script>
/* année + header sticky */
document.getElementById('year').textContent = new Date().getFullYear();

/* Reveal on scroll (identique) */
(function(){const h=document.getElementById('site-header');const t=()=>{if(window.scrollY>10)h.classList.add('scrolled');else h.classList.remove('scrolled')};t();window.addEventListener('scroll',t,{passive:true})})();
(function(){const els=[...document.querySelectorAll('.reveal')]; const io=new IntersectionObserver(es=>es.forEach(e=>{if(e.isIntersecting){e.target.classList.add('is-visible');io.unobserve(e.target)}}),{threshold:.12}); els.forEach(el=>io.observe(el));})();

/* Typing effect (identique) */
(function(){
  const SPEED = 22;
  const els = [...document.querySelectorAll('.type-on-view')];
  els.forEach(el=>{
    const full = (el.getAttribute('data-text') || el.textContent || '').trim();
    el.dataset.fullText = full; el.textContent = ''; el.__typingTimer=null; el.__ready=true;
  });
  function type(el){
    clearTimeout(el.__typingTimer);
    const full = el.dataset.fullText || ''; el.textContent = ''; let i=0;
    (function tick(){ el.textContent = full.slice(0, ++i);
      if(i < full.length) el.__typingTimer=setTimeout(tick, SPEED); else {el.__typingTimer=null; el.__ready=false;}
    })();
  }
  const io = new IntersectionObserver(entries=>{
    entries.forEach(entry=>{
      const el = entry.target;
      if(entry.isIntersecting){ if(el.__ready) type(el); }
      else { el.__ready = true; clearTimeout(el.__typingTimer); el.__typingTimer=null; }
    });
  }, { threshold: 0.4, rootMargin: '0px 0px -10% 0px' });
  els.forEach(el=>io.observe(el));
})();

/* Témoignages + Sticky CTA (identique) */
(function(){
  const wrap=document.getElementById('testi'); if(!wrap) return;
  const track=wrap.querySelector('.testi-track');
  const dots=[...document.querySelectorAll('#testiNav .dot')];
  let i=0; const go=n=>{i=n;track.style.transform=`translateX(-${100*i}%)`;dots.forEach((d,k)=>d.classList.toggle('active',k===i))};
  dots.forEach(d=>d.addEventListener('click',()=>go(+d.dataset.i)));
  setInterval(()=>go((i+1)%dots.length),5000);
})();
(function(){
  const sc=document.getElementById('stickyCta'); if(!sc) return;
  const hero=document.querySelector('.hero--image'); const anchors=document.querySelectorAll('.cta-anchor');
  let heroVisible=true, anchorVisible=false;
  const apply=()=>{ sc.style.display=(heroVisible||anchorVisible)?'none':'flex'; };
  const ioHero=new IntersectionObserver(([e])=>{heroVisible=e.isIntersecting;apply();},{threshold:.05}); ioHero.observe(hero);
  const ioAnch=new IntersectionObserver(entries=>{anchorVisible=entries.some(e=>e.isIntersecting);apply();},{threshold:.2}); anchors.forEach(a=>ioAnch.observe(a)); apply();
})();

/* Analyse via Cloudflare Worker (identique) */
const WORKER_URL="https://awenoria.bmavcontact.workers.dev/analyze?v=2025-10-15";
const normalizeUrl=u=>{if(!u) return ""; u=u.trim(); if(!/^https?:\/\//i.test(u)) u="https://"+u; return u;};
const pct=n=>Number.isFinite(n)?`${Math.round(n)}%`:"—";

function buildResultUI(data,site){
  const s=data.scores||{}, rgpd=data.rgpd||{}, legal=data.legal||{}, a11y=data.a11y||{};
  const box=document.getElementById('resultat'); box.style.display='block';
  const detailId="detail-"+Date.now();
  box.innerHTML=`
    <div class="header">
      <h3>Résultats pour <span class="tag">${(data.finalUrl||site)}</span></h3>
      <span class="small">Analyse locale — aucune donnée conservée</span>
    </div>
    <div class="summary">
      <div class="card-mini"><b>RGPD</b><span>${pct(s.rgpd)} · ${rgpd.policyLink?"Politique détectée":"Politique non détectée"} ${rgpd.cookiesWords?"· Cookies":""}</span></div>
      <div class="card-mini"><b>Mentions légales</b><span>${pct(s.mentions)} · ${legal.mentionsLink?"Lien détecté":"Lien non détecté"}</span></div>
      <div class="card-mini"><b>Accessibilité</b><span>${pct(s.accessibilite)} · ALT ${a11y.imgWithAlt||0}/${a11y.imgCount||0}</span></div>
    </div>
    <div class="footer">
      <button class="btn" onclick="toggleDetail('${detailId}')">Accéder au détail</button>
      <button class="btn ghost" onclick="exportResultPDF()">Exporter en PDF</button>
      <button class="btn link" onclick='downloadJSON(${JSON.stringify(JSON.stringify(data)).replace(/'/g,"&#39;")})'>Télécharger le JSON</button>
    </div>
    <div id="${detailId}" class="detail">
      <div class="grid">
        <div class="box">
          <h4>RGPD</h4>
          <ul>
            <li>Politique de confidentialité : <b>${rgpd.policyLink?"présente":"absente"}</b></li>
            <li>Cookies : ${rgpd.cookiesWords?"mots-clés détectés":"non détectés"}</li>
            <li>Autres indices : ${rgpd.other||"—"}</li>
          </ul>
        </div>
        <div class="box">
          <h4>Mentions légales</h4>
          <ul>
            <li>Lien “mentions” : <b>${legal.mentionsLink?"présent":"absent"}</b></li>
            <li>Infos éditeur/hébergeur : ${legal.hasPublisher?"détectées":"—"}</li>
          </ul>
        </div>
        <div class="box">
          <h4>Accessibilité</h4>
          <ul>
            <li>Images avec ALT : <b>${a11y.imgWithAlt||0}/${a11y.imgCount||0}</b></li>
            <li>Autres repères : ${a11y.notes||"—"}</li>
          </ul>
        </div>
      </div>
      <p class="small" style="margin-top:10px">Pré-diagnostic automatique. Pour un avis formel, <a href="contact.html">contactez un expert</a>.</p>
    </div>`;
}
function toggleDetail(id){const el=document.getElementById(id); if(!el) return; el.style.display = el.style.display==='block' ? 'none' : 'block';}
function exportResultPDF(){ window.print(); }
function downloadJSON(jsonString){ const blob=new Blob([JSON.parse(jsonString)],{type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='awenoria-analyse.json'; a.click(); URL.revokeObjectURL(a.href); }

async function analyser(){
  const input=document.getElementById('url'); const site=normalizeUrl(input.value);
  const box=document.getElementById('resultat');
  if(!site){ alert("Merci d'entrer une URL."); return; }
  box.style.display='block'; box.innerHTML='<p>Analyse en cours…</p>';
  try{
    const res=await fetch(`${WORKER_URL}?url=${encodeURIComponent(site)}`,{headers:{accept:"application/json"},mode:'cors',cache:'no-store'});
    const data=await res.json().catch(()=>({}));
    if(!res.ok || data.ok===false || !data){ throw new Error(data?.error || `Analyse indisponible (${res.status})`); }
    buildResultUI(data,site);
  }catch(e){
    console.error(e);
    const demo={finalUrl:site,scores:{global:80,rgpd:72,mentions:58,accessibilite:86},rgpd:{policyLink:true,cookiesWords:true},legal:{mentionsLink:false,hasPublisher:false},a11y:{imgWithAlt:24,imgCount:26}};
    box.innerHTML = `<p class="small" style="color:#b3261e"><b>Info :</b> l’analyse est momentanément indisponible. Exemple de rapport affiché.</p>`;
    buildResultUI(demo,site);
  }
}

/* AJOUT AWENORIA — Contenu de la modale enrichi */
const TOPIC_CONTENT={
  policy:`<h3>Politique de confidentialité & mentions RGPD</h3>
  <p><b>Objectif.</b> Expliquer quelles données sont collectées, à quelles fins, sur quelle base légale et pendant combien de temps.</p>
  <p><b>Vérifié automatiquement.</b> Présence d’un lien visible, existence de sections clés (finalités, droits, contact, cookies).</p>
  <p><b>À faire.</b> Mettre à jour les bases légales, ajouter un contact clair (DPO ou support), dater la dernière mise à jour.</p>`,

  legalbase:`<h3>Base légale, droits, DPO & contacts</h3>
  <p><b>Objectif.</b> Rendre vos bases légales explicites (contrat, intérêt légitime, consentement…), et expliquer comment exercer les droits (accès, effacement, opposition…).</p>
  <p><b>À faire.</b> Ajouter des exemples concrets et un canal de contact dédié.</p>`,

  forms:`<h3>Formulaires : information au point de collecte</h3>
  <p><b>Objectif.</b> Informer au moment où l’utilisateur fournit ses données.</p>
  <p><b>Bonnes pratiques.</b> Mention courte près du bouton, lien “Politique de confidentialité”, cases de consentement si nécessaires.</p>`,

  alt:`<h3>ALT images & repères ARIA</h3>
  <p><b>Objectif.</b> Accessibilité via lecteurs d’écran.</p>
  <p><b>Vérifié automatiquement.</b> Proportion d’images avec <code>alt</code> et présence de landmarks sémantiques.</p>`,

  contrast:`<h3>Contrastes, sémantique, navigation clavier</h3>
  <p><b>Objectif.</b> Lisibilité et usage sans souris.</p>
  <p><b>À surveiller.</b> Contraste, titres, focus visible, ordre de tabulation.</p>`,

  a11ydec:`<h3>Déclaration d’accessibilité</h3>
  <p><b>Objectif.</b> Publier votre niveau de conformité, les contenus non accessibles et une voie de contact/médiation.</p>
  <p><b>À faire.</b> Lier la déclaration depuis le pied de page, la dater et la maintenir à jour.</p>`,

  mentions:`<h3>Mentions légales — éditeur / hébergeur / contact</h3>
  <p><b>Objectif.</b> Identifier clairement l’éditeur et l’hébergeur, et fournir un moyen de contact.</p>
  <p><b>À faire.</b> Raison sociale, adresse, SIREN/RCS, TVA si applicable, et mentions e-commerce le cas échéant.</p>`,

  rcs:`<h3>RCS / SIREN / TVA</h3>
  <p><b>Objectif.</b> Afficher les identifiants requis selon le statut.</p>
  <p><b>Conseil.</b> Harmoniser ces infos sur toutes les pages légales et documents.</p>`,

  cgu:`<h3>CGU / CGV / rétractation e-commerce</h3>
  <p><b>Objectif.</b> Encadrer l’usage et les achats (prix, livraison, service client, médiation, droit de rétractation).</p>
  <p><b>À faire.</b> Lien depuis le pied de page, conditions lisibles et à jour.</p>`
};
const modal=document.getElementById('modal'); const modalTitle=document.getElementById('modalTitle'); const modalBody=document.getElementById('modalBody');
function openModal(label,key){ modalTitle.textContent=label; modalBody.innerHTML=TOPIC_CONTENT[key]||"<p>Contenu à venir.</p>"; modal.style.display='flex'; }
function closeModal(){ modal.style.display='none'; }
modal.addEventListener('click',e=>{ if(e.target===modal) closeModal(); });
document.querySelectorAll('.cc li').forEach(li=>li.addEventListener('click',()=>openModal(li.textContent.trim(), li.dataset.topic)));

/* FAQ — accordéon accessible (identique) */
(function(){
  const list = document.getElementById('faqList'); if(!list) return;
  const items = [...list.querySelectorAll('.faq-item')];
  function closeItem(li){ if(!li.hasAttribute('open')) return; const btn=li.querySelector('.faq-q'); const panel=li.querySelector('.faq-a'); btn.setAttribute('aria-expanded','false'); li.removeAttribute('open'); panel.style.maxHeight = panel.scrollHeight + 'px'; requestAnimationFrame(()=>{ panel.style.maxHeight='0px'; }); }
  function openItem(li){ items.forEach(it=>{ if(it!==li) closeItem(it); }); const btn=li.querySelector('.faq-q'); const panel=li.querySelector('.faq-a'); btn.setAttribute('aria-expanded','true'); li.setAttribute('open',''); panel.style.maxHeight='0px'; requestAnimationFrame(()=>{ panel.style.maxHeight=panel.scrollHeight+'px'; }); panel.addEventListener('transitionend', function tidy(e){ if(e.propertyName==='max-height' && li.hasAttribute('open')){ panel.style.maxHeight='none'; panel.removeEventListener('transitionend', tidy);} }); }
  items.forEach(li=>{
    const btn=li.querySelector('.faq-q'); const panel=li.querySelector('.faq-a'); if(!btn||!panel) return;
    btn.addEventListener('click', ()=>{ const expanded=btn.getAttribute('aria-expanded')==='true'; expanded?closeItem(li):openItem(li); });
    btn.addEventListener('keydown', (e)=>{ const idx=items.indexOf(li); if(e.key==='ArrowDown'){ e.preventDefault(); items[(idx+1)%items.length].querySelector('.faq-q').focus(); } if(e.key==='ArrowUp'){ e.preventDefault(); items[(idx-1+items.length)%items.length].querySelector('.faq-q').focus(); } if(e.key==='Home'){ e.preventDefault(); items[0].querySelector('.faq-q').focus(); } if(e.key==='End'){ e.preventDefault(); items[items.length-1].querySelector('.faq-q').focus(); } });
  });
})();
</script>
</body>
</html>
