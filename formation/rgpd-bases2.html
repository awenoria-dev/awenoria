<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Fiche formation – Awenoria</title>
  <meta name="description" content="Détail de la formation : objectifs, programme, durée, modalités. Présentiel / distanciel, supports et attestation inclus." />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Polices (comme Catalogue) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Manrope:opsz,wght@12..96,300..800&display=swap" rel="stylesheet">

  <!-- Favicons (chemins depuis /formation/) -->
  <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16.png">

  <!-- CSS global Awenoria (indispensable pour header/footer/nav) -->
  <link rel="stylesheet" href="../assets/awenoria.css?v=1">

  <style>
    :root{
      --ink:#0b1730; --blue:#0066ff; --copper:#ff8a3d; --muted:#6b7c90;
      --panel:#fff; --bg:#f5f7ff; --radius:24px; --shadow:0 25px 50px -12px rgba(0,0,0,.15);
    }
    @media (prefers-color-scheme:dark){
      :root{ --ink:#f5f7ff; --blue:#3d8bff; --copper:#ff9f5f; --muted:#a1b0c7; --panel:#0c111c; --bg:#0a0f18; }
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,-apple-system,Arial,sans-serif;color:var(--ink);background:var(--bg);line-height:1.65;-webkit-font-smoothing:antialiased}

    /* HERO */
    .hero{position:relative;min-height:60vh;display:grid;place-items:center;text-align:center;color:#fff;overflow:hidden;
      background:
        radial-gradient(140% 150% at 10% -20%, rgba(255,255,255,.15), transparent 60%),
        radial-gradient(120% 120% at 120% 10%, rgba(255,255,255,.10), transparent 60%),
        linear-gradient(180deg, #0033cc 0%, #0066ff 100%);}
    .hero canvas{position:absolute;inset:0;width:100%;height:100%}
    .hero-inner{position:relative;z-index:1;max-width:1000px;padding:0 20px}
    .hero h1{font-family:"Manrope",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;font-size:clamp(40px,6vw,64px);font-weight:800;letter-spacing:-.02em;line-height:1.05}
    .hero p{margin-top:10px;font-size:18px;color:#e6f0ff}

    /* PAGE */
    .section{max-width:1200px;margin:-40px auto 80px;padding:0 20px;position:relative;z-index:2}
    .grid{display:grid;grid-template-columns:2fr 1fr;gap:24px}
    @media (max-width:980px){.grid{grid-template-columns:1fr}}
    .card{background:var(--panel);border:1px solid rgba(15,23,42,.08);border-radius:var(--radius);box-shadow:var(--shadow);padding:24px}
    .card h2{margin:0 0 12px}
    .program ul{list-style:disc;padding-left:20px}
    .program li{margin:.22rem 0}
    .meta{display:flex;flex-wrap:wrap;gap:8px;margin:12px 0 18px}
    .tag{border:1px solid rgba(15,23,42,.12);border-radius:999px;padding:6px 10px;font-size:12px;font-weight:800;background:rgba(27,136,255,.06)}
    .note{color:var(--muted);font-size:14px}

    .cta-col{display:grid;grid-template-rows:auto auto;gap:14px;align-content:start}
    .cta-wide{background:transparent;border-radius:999px}
    .btn{display:inline-flex;align-items:center;justify-content:center;font-weight:800;font-size:16px;border-radius:999px;padding:14px 24px;text-decoration:none;border:1px solid transparent}
    .btn.primary{background:var(--copper);color:#fff;box-shadow:0 10px 30px rgba(255,138,61,.30)}
    .btn.primary:hover{transform:translateY(-2px)}
    .breadcrumbs{display:none}
  </style>
</head>
<body>

  <!-- Header injecté -->
  <div id="header"></div>

  <!-- HERO -->
  <section class="hero" aria-label="En-tête visuel">
    <canvas id="heroFx" aria-hidden="true"></canvas>
    <div class="hero-inner">
      <h1 id="course-title">Titre formation</h1>
      <p id="course-pitch">Résumé personnalisé selon l’origine (thématique / public).</p>
      <div id="course-meta" class="meta"></div>
    </div>
  </section>

  <!-- CONTENU -->
  <main class="section" id="content" aria-label="Contenu">
    <div class="grid">
      <article class="card">
        <h2>Programme</h2>
        <div id="course-program" class="program"></div>

        <h2 style="margin-top:16px">Objectifs</h2>
        <ul id="course-objectives"></ul>
      </article>

      <aside class="cta-col">
        <div class="card">
          <h2 style="margin:0 0 8px">Infos pratiques</h2>
          <ul class="note" id="practical-list" style="padding-left:18px;margin:8px 0 0">
            <li>Formats : atelier 2h, 1/2 journée, 1 journée</li>
            <li>Modalités : présentiel ou distanciel</li>
            <li>Financement : selon OPCO/plan interne</li>
          </ul>
          <p class="note" style="margin-top:12px">Supports & modèles fournis • Quiz & attestation inclus</p>
        </div>
        <div class="cta-wide">
          <a class="btn primary" href="../index.html#contact">Demander un devis</a>
        </div>
      </aside>
    </div>
  </main>

  <!-- Footer injecté -->
  <div id="footer"></div>

  <!-- Fond animé -->
  <script>
    (function(){
      const c=document.getElementById('heroFx'); if(!c) return;
      const ctx=c.getContext('2d'); let w,h; const P=[]; const N=60, R=2, D=120;
      function size(){ w=c.width=innerWidth; h=c.height=innerHeight*.55 }
      function add(){ for(let i=0;i<N;i++) P.push({x:Math.random()*w,y:Math.random()*h,vx:(Math.random()-.5)*.35,vy:(Math.random()-.5)*.35}) }
      function draw(){
        ctx.clearRect(0,0,w,h);
        for(const p of P){
          p.x+=p.vx; p.y+=p.vy;
          if(p.x<0||p.x>w) p.vx*=-1; if(p.y<0||p.y>h) p.vy*=-1;
          ctx.beginPath(); ctx.arc(p.x,p.y,R,0,Math.PI*2); ctx.fillStyle='rgba(255,255,255,.25)'; ctx.fill();
        }
        for(let i=0;i<P.length;i++)for(let j=i+1;j<P.length;j++){
          const a=P[i],b=P[j],d=Math.hypot(a.x-b.x,a.y-b.y);
          if(d<D){ ctx.beginPath(); ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y);
            ctx.strokeStyle=`rgba(255,255,255,${1-d/D})`; ctx.stroke(); }
        }
        requestAnimationFrame(draw);
      }
      addEventListener('resize', size); size(); add(); draw();
    })();
  </script>

  <!-- Données dynamiques (identique à ta version) -->
  <script type="module">
    const DEFAULT_TITLE="Titre formation";
    const DEFAULT_PITCH="Résumé personnalisé selon l’origine (thématique / public).";
    const DEFAULT_TAGS=['1/2 journée','Intermédiaire','Distanciel','Présentiel'];
    const DEFAULT_PROGRAM=[
      "Base légale & minimisation",
      "Registre : quoi, comment, preuves",
      "Droits des personnes : process & SLA",
      "Plan d’action 90 jours"
    ];
    const DEFAULT_OBJECTIVES=[
      "Comprendre les obligations et le périmètre",
      "Savoir appliquer dans votre contexte",
      "Produire les premiers livrables utiles",
      "Établir une feuille de route opérationnelle"
    ];

    const titleEl = document.getElementById('course-title');
    const pitchEl = document.getElementById('course-pitch');
    const metaEl  = document.getElementById('course-meta');
    const progEl  = document.getElementById('course-program');
    const objEl   = document.getElementById('course-objectives');

    try{
      const mod = await import("../js/courses-data.js");
      const COURSES = mod.COURSES||[];
      const slug = location.pathname.split('/').pop().replace('.html','');
      const params=new URLSearchParams(location.search);
      const from=params.get('from'), theme=params.get('theme'), audience=params.get('public');

      const course=COURSES.find(c=>c.slug===slug);

      const title=course?.title||DEFAULT_TITLE;
      const summary=course?.summary||DEFAULT_PITCH;
      const pitch=(from==='public'&&audience&&course?.pitchByAudience?.[audience])?course.pitchByAudience[audience]:(from==='theme'&&theme&&course?.pitchByTheme?.[theme])?course.pitchByTheme[theme]:summary;

      titleEl.textContent=title; pitchEl.textContent=pitch;

      const dur=course?.duration?`<span class="tag">${course.duration}</span>`:''; 
      const lvl=course?.level?`<span class="tag">${course.level}</span>`:''; 
      const mods=(course?.modalities||[]).map(m=>`<span class="tag">${m}</span>`).join('');
      metaEl.innerHTML=(dur||lvl||mods)?(dur+lvl+mods):DEFAULT_TAGS.map(t=>`<span class="tag">${t}</span>`).join('');

      const items=(course?.program||DEFAULT_PROGRAM).map(li=>`<li>${li}</li>`).join('');
      progEl.innerHTML=`<ul>${items}</ul>`;
      objEl.innerHTML=(course?.objectives||DEFAULT_OBJECTIVES).map(o=>`<li>${o}</li>`).join('');

      document.title=`${title} – Awenoria`;
    }catch(e){
      titleEl.textContent=DEFAULT_TITLE;
      pitchEl.textContent=DEFAULT_PITCH;
      metaEl.innerHTML=DEFAULT_TAGS.map(t=>`<span class="tag">${t}</span>`).join('');
      progEl.innerHTML=`<ul>${DEFAULT_PROGRAM.map(li=>`<li>${li}</li>`).join('')}</ul>`;
      objEl.innerHTML=DEFAULT_OBJECTIVES.map(o=>`<li>${o}</li>`).join('');
    }
  </script>

  <!-- Injection header/footer + compat GitHub Pages (identique Catalogue) -->
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const headMount = document.getElementById("header");
    const footMount = document.getElementById("footer");
    if (!headMount && !footMount) return;

    const isGh = /github\.io$/.test(location.hostname);
    let base = "/";
    if (isGh) {
      const parts = location.pathname.split("/").filter(Boolean);
      base = parts.length ? `/${parts[0]}/` : "/";
    }

    const candidates = (p) => {
      const clean = p.replace(/^\//, "");
      return [ base + clean, "./" + clean, "../" + clean ];
    };
    async function fetchAny(paths) {
      const queue = paths.flatMap(candidates);
      for (const u of queue) {
        try { const r = await fetch(u, { cache: "no-cache" }); if (r.ok) return r.text(); } catch(_) {}
      }
      throw new Error("Aucun chemin valide parmi: " + paths.join(", "));
    }
    function fixRootUrls(container) {
      container.querySelectorAll('a[href^="/"], img[src^="/"], link[href^="/"], script[src^="/"]')
        .forEach(el => {
          const attr = el.hasAttribute("href") ? "href" : "src";
          const val = el.getAttribute(attr);
          if (/^\/\//.test(val)) return;
          el.setAttribute(attr, base + val.replace(/^\//, ""));
        });
    }

    // HEADER
    if (headMount) {
      fetchAny(["header.html", "partials/header.html"])
        .then(html => {
          headMount.innerHTML = html;
          fixRootUrls(headMount);
          return fetchAny(["assets/nav.js", "nav.js"]);
        })
        .then(code => {
          const s = document.createElement("script");
          if (/\b(import|export)\b/.test(code)) s.type = "module";
          s.textContent = code;
          document.body.appendChild(s);
        })
        .catch(() => { headMount.innerHTML = "<!-- Header introuvable -->"; });
    }

    // FOOTER
    if (footMount) {
      fetchAny(["footer.html", "partials/footer.html"])
        .then(html => { footMount.innerHTML = html; fixRootUrls(footMount); })
        .catch(() => { footMount.innerHTML = "<!-- Footer introuvable -->"; });
    }
  });
  </script>
</body>
</html>
