<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Liste des fiches de formation ‚Äì Awenoria</title>
  <meta name="description" content="Page interne listant toutes les fiches de formation g√©n√©r√©es automatiquement depuis js/courses-data.js." />
  <meta name="theme-color" content="#0f5f9a" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:opsz,wght@12..96,300..800&display=swap" rel="stylesheet">

  <style>
    :root{
      --font:"Manrope",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      --bg:#f6f9fc; --panel:#fff; --muted:#4a6176; --text:#0f5f9a;
      --brand:#0f5f9a; --copper:#ff8a3d; --shadow:0 12px 28px rgba(0,0,0,.08);
      --maxw:1200px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text); font-family:var(--font);
      background:
        radial-gradient(1400px 700px at 10% -20%, #eef6ff 0%, rgba(238,246,255,.6) 45%, transparent 60%),
        linear-gradient(180deg,#fff 0%,#f6f9fc 100%);
      -webkit-font-smoothing:antialiased;
    }
    a{color:inherit; text-decoration:none}
    a:hover{text-decoration:underline}

    /* Header simple */
    header{position:sticky; top:0; z-index:10; background:rgba(255,255,255,.85);
      backdrop-filter:blur(10px); border-bottom:1px solid rgba(15,23,32,.08)}
    .nav{max-width:var(--maxw); margin:0 auto; padding:10px 16px; display:flex; align-items:center; gap:16px}
    .nav img{height: clamp(56px,8vw,96px); display:block}

    /* Section titre */
    .wrap{max-width:var(--maxw); margin:28px auto; padding:0 20px}
    h1{font-weight:800; font-size:clamp(26px,4vw,44px); text-align:center; margin:6px 0}
    .sub{color:var(--muted); text-align:center; margin:0 0 8px}
    .underline{width:84px; height:4px; border-radius:999px; background:var(--copper); margin:12px auto 24px; opacity:.95}

    /* Grille + cartes */
    #cards{display:grid; grid-template-columns:repeat(auto-fit,minmax(320px,1fr)); gap:20px}
    .card{background:rgba(255,255,255,.86); border:1px solid rgba(15,23,32,.08);
      border-radius:22px; padding:20px; box-shadow:var(--shadow);
      transition:transform .2s ease, box-shadow .3s ease}
    .card:hover{transform:translateY(-3px); box-shadow:0 8px 20px rgba(0,0,0,.12)}
    .card h3{margin:0 0 8px; font-weight:800}
    .meta{display:flex; flex-wrap:wrap; gap:8px; margin:8px 0}
    .tag{border:1px solid rgba(15,23,32,.12); border-radius:999px; padding:6px 10px;
      font-size:12px; font-weight:800; background:rgba(27,136,255,.06)}
    .btn{display:inline-flex; align-items:center; justify-content:center; font-weight:800;
      border-radius:9999px; padding:12px 20px; border:1px solid transparent;
      background:rgba(27,136,255,.80); color:#fff; text-decoration:none}
    .btn:hover{background:rgba(27,136,255,.9)}

    footer{text-align:center; color:var(--muted); margin:28px 0}
    footer a{color:var(--brand); font-weight:800}

    /* Apparition douce des cartes */
    @media (prefers-reduced-motion: no-preference){
      .card{opacity:0; transform:translateY(12px); transition:opacity .5s ease, transform .5s ease}
      .card.reveal{opacity:1; transform:translateY(0)}
    }
  </style>
</head>
<body>

<header>
  <div class="nav">
    <a href="../index.html" aria-label="Aller √† l‚Äôaccueil">
      <img src="../images/logo.png" alt="Awenoria">
    </a>
  </div>
</header>

<main class="wrap">
  <h1>Liste des fiches de formation</h1>
  <p class="sub">Page interne de test ‚Äî g√©n√©ration automatique depuis <code>js/courses-data.js</code>.</p>
  <div class="underline"></div>

  <div id="cards" aria-live="polite"></div>

  <p class="sub" style="margin-top:16px">
    <a class="btn" href="../nos-formations.html#contact">Demander un programme d√©taill√©</a>
  </p>
</main>

<footer>
  ‚Üê <a href="../formations-liste.html">Retour au catalogue principal</a>
</footer>

<noscript>
  <div class="wrap"><p>Activez JavaScript pour voir la liste des fiches.</p></div>
</noscript>

<!-- G√©n√©ration des cartes -->
<script>
const root = document.getElementById('cards');
if (!root) return;

function tag(t){ return `<span class="tag">${t}</span>`; }

function render(list){
  if (!Array.isArray(list) || list.length === 0){
    root.innerHTML = '<p>Aucune formation trouv√©e.</p>';
    return;
  }
  root.innerHTML = list.map(c => `
    <article class="card">
      <h3>${c.title}</h3>
      <div class="meta">
        ${c.duration ? tag(c.duration) : ''}
        ${c.level ? tag(c.level) : ''}
        ${(c.modalities||[]).map(tag).join('')}
      </div>
      <p>${c.summary || ''}</p>
      <p style="margin-top:8px">
        <a class="btn" href="./${c.slug}.html?from=catalogue"
           aria-label="Voir la fiche d√©taill√©e de ${c.title}">Voir la fiche</a>
      </p>
    </article>
  `).join('');
}

// üîπ Version simple : charge directement le JS (pas de CORS, pas de module)
const s = document.createElement('script');
s.src = '../js/courses-data.js';
s.onload = () => render(window.COURSES);
s.onerror = () => root.innerHTML = `
  <p style="color:#b00"><strong>Erreur de chargement des donn√©es.</strong></p>
  <p>V√©rifie le chemin <code>../js/courses-data.js</code>.</p>`;
document.head.appendChild(s);
</script>


    // Apparition douce
    const reduce = matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (!reduce && 'IntersectionObserver' in window){
      const cards = root.querySelectorAll('.card');
      const io = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if (entry.isIntersecting){
            const i = [...entry.target.parentElement.children].indexOf(entry.target);
            entry.target.style.transitionDelay = `${Math.min(i*80, 400)}ms`;
            entry.target.classList.add('reveal');
            obs.unobserve(entry.target);
          }
        });
      }, { threshold: 0.12 });
      cards.forEach(c => io.observe(c));
    } else {
      root.querySelectorAll('.card').forEach(c => c.classList.add('reveal'));
    }
  }

  // 1) Essaye l'import ESM
  (async () => {
    try {
      const mod = await import('../js/courses-data.js');
      render(mod.COURSES);
    } catch (e) {
      // 2) Fallback non-module (global window.COURSES)
      const s = document.createElement('script');
      s.src = '../js/courses-data.js';
      s.onload = () => render(window.COURSES);
      s.onerror = () => root.innerHTML = `
        <p style="color:#b00"><strong>Erreur de chargement des donn√©es.</strong></p>
        <p>V√©rifie le chemin <code>../js/courses-data.js</code> depuis <code>/formation/</code>.</p>`;
      document.head.appendChild(s);
    }
  })();
})();
</script>

  // Animation d'apparition (progressive)
  const reduce = matchMedia('(prefers-reduced-motion: reduce)').matches;
  if (!reduce && 'IntersectionObserver' in window){
    const cards = document.querySelectorAll('#cards .card');
    const io = new IntersectionObserver((entries, obs) => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          const i = [...entry.target.parentElement.children].indexOf(entry.target);
          entry.target.style.transitionDelay = `${Math.min(i*80, 400)}ms`;
          entry.target.classList.add('reveal');
          obs.unobserve(entry.target);
        }
      });
    }, {threshold: 0.12});
    cards.forEach(c => io.observe(c));
  } else {
    document.querySelectorAll('#cards .card').forEach(c => c.classList.add('reveal'));
  }
</script>
</body>
</html>
