<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Liste des fiches de formation – Awenoria</title>
  <meta name="description" content="Page interne de test — génération automatique depuis js/courses-data.js.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:opsz,wght@12..96,300..800&display=swap" rel="stylesheet">
  <style>
    :root{ --font-ui:"Manrope",system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; --bg:#f6f9fc; --panel:#fff; --muted:#4a6176; --text:#0f5f9a; --brand:#0f5f9a; --copper:#ff8a3d; --radius:16px; --shadow:0 12px 28px rgba(0,0,0,.08); --maxw:1100px }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;color:var(--text);font-family:var(--font-ui);background:radial-gradient(1400px 700px at 10% -20%,#eef6ff 0%,rgba(238,246,255,.6) 45%,transparent 60%),linear-gradient(180deg,#fff 0%,#f6f9fc 100%)}
    h1{font-size:clamp(26px,4.5vw,42px);font-weight:800;text-align:center;margin:26px 0 6px}
    .subtitle{color:var(--muted);text-align:center;margin:0 0 12px}
    .underline{width:80px;height:4px;border-radius:999px;background:var(--copper);margin:10px auto 22px;opacity:.9}
    .wrap{max-width:var(--maxw);margin:0 auto;padding:0 20px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:18px}
    .card{border:1px solid rgba(15,23,32,.08);background:#fff;border-radius:22px;padding:20px;box-shadow:var(--shadow);transition:transform .2s ease, box-shadow .3s ease}
    .card:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(15,23,32,.12)}
    .card h3{margin:0 0 6px}
    .meta{display:flex;flex-wrap:wrap;gap:8px;margin:6px 0}
    .tag{border:1px solid rgba(15,23,32,.12);border-radius:999px;padding:6px 10px;font-size:12px;font-weight:800;background:rgba(27,136,255,.06)}
    .btn{display:inline-flex;align-items:center;justify-content:center;font-weight:800;border-radius:9999px;padding:12px 20px;font-size:16px;text-decoration:none;border:1px solid transparent;background:rgba(27,136,255,.80);color:#fff;box-shadow:inset 0 0 12px rgba(255,255,255,.15),0 4px 18px rgba(27,136,255,.30)}
    .cta{display:flex;justify-content:center;margin:16px 0}
    .back{color:var(--brand);font-weight:800;text-align:center;margin:8px 0 32px}
    @media (prefers-reduced-motion: no-preference){
      .card{opacity:0;transform:translateY(12px);transition:opacity .5s ease, transform .5s ease}
      .card.reveal{opacity:1;transform:translateY(0)}
    }
  </style>
</head>
<body>
  <h1>Liste des fiches de formation</h1>
  <p class="subtitle">Page interne de test — génération automatique depuis <code>js/courses-data.js</code>.</p>
  <div class="underline"></div>

  <div class="wrap">
    <div id="cards" class="grid" aria-live="polite"></div>

    <div class="cta">
      <a class="btn" href="/nos-formations.html#contact">Demander un programme détaillé</a>
    </div>
    <p class="back">← <a href="../formations-liste.html">Retour au catalogue principal</a></p>
  </div>

  <!-- 1) on ESSAIE la version globale si elle existe -->
  <script src="../js/courses-data.js"></script>

  <script>
    (async () => {
      const root = document.getElementById('cards');

      // charge COURSES depuis window ou via import dynamique si besoin
      async function loadCourses() {
        if (Array.isArray(window.COURSES)) return window.COURSES;   // version globale
        try {
          const mod = await import('../js/courses-data.js');         // version module
          if (Array.isArray(mod.COURSES)) return mod.COURSES;
        } catch(e) {
          console.warn('Import module échoué (ok si version globale) :', e);
        }
        return [];
      }

      const COURSES = await loadCourses();

      if (!COURSES.length) {
        root.innerHTML = '<p>Aucune formation trouvée.</p>';
        return;
      }

      // rendu
      root.innerHTML = COURSES.map(c => `
        <article class="card">
          <h3>${c.title}</h3>
          <div class="meta">
            ${c.duration ? `<span class="tag">${c.duration}</span>` : ''}
            ${c.level ? `<span class="tag">${c.level}</span>` : ''}
            ${(c.modalities || []).map(m => `<span class="tag">${m}</span>`).join('')}
          </div>
          <p>${c.summary || ''}</p>
          <p style="margin-top:8px">
            <a class="btn" href="./${c.slug}.html?from=catalogue" aria-label="Voir la fiche détaillée de ${c.title}">Voir la fiche</a>
          </p>
        </article>
      `).join('');

      // animation d’apparition
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (!prefersReduced && 'IntersectionObserver' in window) {
        const cards = document.querySelectorAll('#cards .card');
        const io = new IntersectionObserver((entries, obs) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const idx = [...entry.target.parentElement.children].indexOf(entry.target);
              entry.target.style.transitionDelay = `${Math.min(idx * 80, 400)}ms`;
              entry.target.classList.add('reveal');
              obs.unobserve(entry.target);
            }
          });
        }, { threshold: 0.12 });
        cards.forEach(c => io.observe(c));
      } else {
        document.querySelectorAll('#cards .card').forEach(c => c.classList.add('reveal'));
      }
    })();
  </script>
</body>
</html>
